## 팩토리(Factory) 패턴

파이썬의 모든 것은 객체다. 

파이썬의 함수는 일급 객체이다. 때문에 인수로 전달하거나 반환 값으로 넘겨 주거나 런타임에서 생성할 수도 있다. 

C언어와 같은 언어에서는 함수는 객체가 아니다. 때문에 동적으로 생성 하거나 반환값으로 넘겨줄 수 없다. 

(함수 포인터같은걸로 비슷하게 만들 수는 있다.)


**때문에 파이썬에서는 팩토리 패턴이 그다지 필요 하지 않다.(From:파이썬클린코드)**

이미 언어단에서 완벽히 추상화가 진행되어 있기 때문에 잘 사용하기만 하면 된다. 


--------------------
팩토리 패턴은 2가지로 세분화 되어 있다. 

#### 1. 팩토리 메소드 패턴 
 
객체를 생성하기 위한 인터페이스를 정의 할 때 어떤 클래스의 인스턴스를 만들 지는 서브 클래스에서 결정하게 한다. 

#### 2. 추상 팩토리 패턴

인터페이스를 이용해 서로 연관되거나 의존하는 객체들을 구상 클래스를 지정하지 않고도 생성한다. 

일반적으로 객체를 생성하게 되면 \__init__ 함수가 호출되면서 구상 클래스의 인스턴스를 생성한다.

그럼 인터페이스에서 객체를 만들 때 C같은 프로그래밍 언어면 다음과 같이 아래와 같은 식의 코드가 필요할 수도 있다. 

#### 3. 파이썬에서의 팩토리 패턴 

```python
class Operator():
    def __init__(self,name):
        self._operation = self.operation_factory(name)
        
    def __call__(or1,or2):
        return self._operation(or1,or2)

    @staticmethod
    def operation_factory(name='add'):
        if name =='add':
            operator = Add()
        elif name =='mul':
            operator = Mul()
        elif name =='div':
            operator = Div()
        elif name =='sub':
            operator = Sub()
        return operator 
```

이런 방식은 **새로운 구상 클래스(여기서는 각 연산 클래스)가 추가되면 인터페이스 코드를 고쳐야 한다.**

코드 재활용 및 변화의 영향에 대한 코드 수정을 최소화 하기 위해서 팩토리 방식은 바뀔 수 있는 부분(각 구상 클래스에 특화된 기능 등)과 바뀌지 않는(상속 가능한) 부분을 분리시켜야 한다는 원칙이 존재한다. 그 **바뀌는 부분을 팩토리로 생성한다는 것.**

그런데 파이썬에서는 그냥 아래와 같이 하면 된다.

```python  
class Operator():
    def __init__(self,CLSNAME):
        self._operation = CLSNAME()
        
    def __call__(or1,or2):
        return self._operation(or1,or2)
```


**별도의 operation 생성을 위한 인터페이스가 필요없다.**

**오히려 객체 생성을 팩토리 방식으로 하면 파이썬 스러운(파이썬의 장점을 활용하는) 코딩 스타일이 아니다.**

대신, 하위 클래스들이 동일한 인터페이스를 보장해야 한다.

이를 강제 위해서는 추상 클래스를 생성하는것이 좋다. 


- **추상 클래스**

추상 클래스란 미구현 추상메소드를 한개 이상 가지며, 자식 클래스에서 해당 추상 메소드를 **반드시 구현하도록 강제한다.**

상속 받은 클래스는 지정된 추상메소드를 오버라이딩 하지 않아도 import자체는 되나 **객체 생성시 오류를 발생하도록 되어있다.** 

[PEP 3119](https://peps.python.org/pep-3119/)에서 abc 라고 하는 추상 베이스 클래스가 추가 되었다. 

ABCMeta 클래스를 사용하면 추상 베이스 클래스를 간단히 ABC에서 파생시켜 만들 수 있다.



